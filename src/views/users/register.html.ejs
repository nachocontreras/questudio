<div>
    <% if (locals.notice) { %>
      <div className="notice"><%= notice %></div>
    <% } %>
    <h3>Registrarse</h3>
    <% if (locals.error) { %>
      <div class="error">
        <%= error %>
      </div>
    <% } %>
    <form action="<%= createUserPath %>" method="post">
      <div class="field">
        <label for="name">Nombre</label>
        <input type="text" name="name" value="<%= locals.name %>" required/>
      </div>
      <div class="field">
        <label for="name">Apellidos</label>
        <input type="text" name="lastname" value="<%= locals.lastname %>" required/>
      </div>
      <div class="field">
        <label for="email">Email</label>
        <input type="email" name="email" value="<%= locals.email %>" required />
      </div>
      <div class="field">
        <label for="password">Contraseña</label>
        <input type="password" name="password" id="password" value="<%= locals.password %>" required/>
      </div>
      <div class="field">
        <label for="confirm_password">Repetir contraseña</label>
        <input type="password" name="confirm_password" id="confirm_password" required/>
      </div>
      <div class="field">
        <label>¿Quién soy?</label>
        <select id="select-user" name="userType">
          <option value="0">Estudiante enseñanza media</option>
          <option value="1">Estudiante universitario</option>
          <!-- <option value="2">Staff universidad</option> -->
        </select>
      </div>
      <div id="field-university" class="field" style="display: none;">
        <label>Pertenezco a:</label>
        <select id="select-universiy" name="universityId">
          <option value="empty"></option>
          <% universitiesList.forEach((university) => { %>
            <option value="<%- university.id %>"><%- university.name %></option>
          <% }) %>
        </select>
      </div>
      <div class="field">
        <input type="submit" id="register" name="sign-up" value="Registrarse" disabled />
      </div>
    </form>
</div>

<script>
    var password = document.getElementById("password")
    , confirm_password = document.getElementById("confirm_password");

    function validatePassword(){
        if(password.value != confirm_password.value) {
            console.log("No coinciden");
            confirm_password.setCustomValidity("Contraseñas no coinciden");
            $("#register").prop('disabled', true);
        } else {
            console.log("Si coinciden");
            $("#register").prop('disabled', false);
            confirm_password.setCustomValidity('');
        }
    }

    password.onchange = validatePassword;
    confirm_password.onkeyup = validatePassword;

    $("#select-user").change(function() {
      if ($(this).val() == "1") {
        $("#field-university").css('display', 'block');
      } else {
        $("#field-university").css('display', 'none');
      }
    });
</script>
